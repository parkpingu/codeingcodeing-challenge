# 9장. 최소한 알고 있어야 할 서버 지식


## 1. OS 계정과 권한
- 리눅스는 계정과 그룹의 개념이 존재하며, 권한을 통해 파일 접근 여부가 결정됨
- 권한 종류:
    | 권한 | 문자 | 숫자 | 설명 |
    |------|------|------|------|
    | 읽기 | r | 4 | 파일 내용을 읽거나 디렉토리 내용을 볼 수 있음 |
    | 쓰기 | w | 2 | 파일을 수정하거나 디렉토리에 파일을 생성/삭제할 수 있음 |
    | 실행 | x | 1 | 파일을 실행하거나 디렉토리에 접근할 수 있음 |
- 파일/디렉토리 권한 확인:
    ```
    $ ls -l
    ```
- 권한 정보는 10자리 문자열로 표시됨 (예: `-rwxr-xr-x`)
  - **1번째 문자**: 파일 타입
    - `-`: 일반 파일
    - `d`: 디렉토리
    - `l`: 심볼릭 링크
  - **2-4번째 문자**: 소유자의 권한
  - **5-7번째 문자**: 그룹의 권한
  - **8-10번째 문자**: 다른 사용자에 대한 권한
- `chmod` 명령어를 사용하여 권한을 변경할 수 있음
  - **숫자 모드**
    - 소유자, 그룹, 다른 계정에 대한 권한을 숫자 3개로 지정하여 권한 변경
    ```
    $ chmod 754 run.sh
    ```
  - **문자 모드**
    - 사용자 : `u`(사용자), `g`(그룹), `o`(다른 사용자), `a`(모두)
    - 동작 : `+`(권한 추가), `-`(권한 제거), `=`(권한 설정)
    - 사용자, 동작, 권한 값을 조합해 권한 변경
    ```
    $ chmod g-x       # 그룹에서 실행 권한 제거
    $ chmod o=rx      # 다른 사용자에게 읽기와 실행 권한 지정
    $ chmod a+r       # 모든 사용자에게 읽기 권한 추가
    ```
- `sudo`로 권한 주기
  - 일반 사용자가 root 권한으로 명령어를 실행할 수 있음
    

## 2. 프로세스
### 프로세스 확인
- `htop`: CPU, 메모리 실시간 확인 도구
- `ps`: 현재 실행 중인 프로세스 조회
- `kill`: 프로세스 종료 명령어
  - `-15`: 정상 종료
  - `-9`: 강제 종료

### 포그라운드와 백그라운드
- **포그라운드**: 터미널에 연결된 프로세스 (키보드 입력, 출력 연결)
- **백그라운드**: 터미널과 연결되지 않은 프로세스
  - `nohup`: HUP 시그널 무시 → 터미널 종료 후에도 실행 유지 가능
  - **HUP 시그널이란?** : 리눅스/유닉스 시스템에서 프로세스에게 터미널 세션 종료를 알리는 시그널
  - 프로세스를 실행하는 명령어 뒤에 `&`를 붙여주면 백그라운드로 실행된다고 한다.



## 3. 디스크 용량
- `df`: 전체 파티션별 사용률 확인 (`-h`: MB/GB 단위 표시)
- `du`: 특정 디렉토리/파일의 디스크 사용량 확인 (`-s`, `-h` 옵션 활용)
- 디스크 용량 관리 팁:
  - 오래된 로그 파일은 백업 후 삭제
  - 압축을 통한 공간 절약 (텍스트/로그 파일은 압축 효율 높음)
  - 로그 초기화: `cp /dev/null out.log`

## 4. 파일 디스크립터 제한
- 프로세스는 데이터 입출력(ex. 파일/소켓 입출력)이 필요할 때 OS로부터 파일 디스크립터 할당 받음
- 사용자의 파일 디스크립터 개수 제한 확인:
  ```
  $ ulimit -a     # 모든 자원 제한 값을 한번에 출력
  $ ulimit -n     # 한 프로세스가 열 수 있는 최대 파일 디스크립터 수
  ``` 
- `/etc/security/limits.conf`: 사용자 단위로 시스템 자원 사용 한도를 설정하는 설정 파일. `ulimit`과 관련된 설정을 영구적으로 적용할 수 있음.

## 5. 시간 동기화
- 서버 시간이 어긋나면 인증 오류 등 다양한 문제 발생 가능
- `chrony`, `ntp` 등을 이용해 시간 주기적 동기화 필요

## 6. 크론을 이용한 스케줄링
- `crontab -l`: 등록된 크론 작업 목록 확인
- `crontab -e`: 현재 사용자에 대한 크론 작업 편집
- 크론 표현식 형식:
  ```
  * * * * *         # 분 시 일 월 요일
  # 0 4 * * 1  → 매주 월요일 새벽 4시에 실행
  ```


## 7. 별칭
- `alias`: 자주 쓰는 명령어를 짧게 정의하여 사용 가능 (현재 터미널 세션에만 적용)
  ```
  $ alias cdweb='cd /var/www/html'
  ```
- `.bashrc`파일 하단에 alias 설정을 추가하여 로그인할 때 자동으로 적용되도록 할 수 있음

## 8. 네트워크 정보 확인
- `ifconfig`: 네트워크 인터페이스 상태 확인
- `nc -z -u -v localhost 443`: 포트 스캔 (UDP 포함)
- `curl`, `wget`: 외부 요청 테스트용
- `netstat`: 네트워크 연결, 포트 점유 상태 확인

    | 옵션 | 설명 |
    |------|------|
    | `-l` | 리스닝 서버 소켓 출력 |
    | `-p` | 소켓을 사용하는 PID/프로그램 이름 출력 |
    | `-u` | UDP 소켓 출력 |
    | `-t` | TCP 소켓 출력 |
    | `-n` | 포트나 주소를 숫자로 출력 |